(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     26339,        596]
NotebookOptionsPosition[     25420,        562]
NotebookOutlinePosition[     25808,        579]
CellTagsIndexPosition[     25765,        576]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["All essential ECAs", "Subsection",
 CellChangeTimes->{{3.653831139351966*^9, 3.6538311741828613`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ECAClass", "=", 
   RowBox[{"{", 
    RowBox[{
    "8", ",", "32", ",", "40", ",", "128", ",", "136", ",", "160", ",", "168",
      ",", "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7", 
     ",", "9", ",", "10", ",", "11", ",", "12", ",", "13", ",", "14", ",", 
     "19", ",", "23", ",", "24", ",", "25", ",", "26", ",", "27", ",", "28", 
     ",", "29", ",", "33", ",", "34", ",", "35", ",", "36", ",", "37", ",", 
     "38", ",", "42", ",", "43", ",", "44", ",", "46", ",", "50", ",", "56", 
     ",", "57", ",", "58", ",", "62", ",", "72", ",", "73", ",", "74", ",", 
     "76", ",", "77", ",", "78", ",", "94", ",", "104", ",", "108", ",", 
     "130", ",", "132", ",", "134", ",", "138", ",", "140", ",", "142", ",", 
     "152", ",", "154", ",", "156", ",", "162", ",", "164", ",", "172", ",", 
     "178", ",", "184", ",", "200", ",", "232", ",", "18", ",", "22", ",", 
     "30", ",", "45", ",", "122", ",", "126", ",", "146", ",", "41", ",", 
     "54", ",", "106", ",", "110"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.582990364451247*^9, 3.582990373525338*^9}, {
   3.582990466904204*^9, 3.5829904817038403`*^9}, {3.582991123613345*^9, 
   3.582991207872808*^9}, {3.650987322376096*^9, 3.6509874255843782`*^9}, {
   3.650987461877019*^9, 3.650987472694442*^9}, 3.6509900123925962`*^9, {
   3.6514974272429943`*^9, 3.651497431012721*^9}, 3.652385787826686*^9, 
   3.652385997556766*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Filter ECA emulation algorithm", "Subsection",
 CellChangeTimes->{{3.653831139351966*^9, 3.653831199570204*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"CheckCandidateCore", "[", 
   RowBox[{"rl_", ",", "cand_", ",", "patt_", ",", "k_", ",", "range_"}], 
   "]"}], ":=", 
  RowBox[{"MatchQ", "[", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"FromDigits", "[", 
        RowBox[{"#", ",", "2"}], "]"}], "&"}], ",", 
      RowBox[{"Partition", "[", 
       RowBox[{
        RowBox[{"CellularAutomaton", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"rl", ",", "2", ",", "range"}], "}"}], ",", 
          RowBox[{"Flatten", "[", 
           RowBox[{"IntegerDigits", "[", 
            RowBox[{
             RowBox[{"patt", "/.", 
              RowBox[{"MapThread", "[", 
               RowBox[{"Rule", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "1"}], "}"}], ",", "cand"}], "}"}], ",", 
                "1"}], "]"}]}], ",", "2", ",", "k"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"{", "k", "}"}], "}"}], "}"}]}], "]"}], ",", "k"}], 
       "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Alternatives", "@@", "cand"}], ")"}], ".."}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.5827291408463373`*^9, 3.5827292045412493`*^9}, {
  3.582729414954419*^9, 3.582729428666843*^9}, {3.5829260214643955`*^9, 
  3.582926028531208*^9}, {3.582926815817791*^9, 3.5829268198581977`*^9}, {
  3.583914088023542*^9, 3.583914124962667*^9}, {3.583914340870924*^9, 
  3.583914341428575*^9}, {3.584106856876873*^9, 3.5841068575468082`*^9}, {
  3.6512103908990192`*^9, 3.651210391920583*^9}, {3.651210528218833*^9, 
  3.65121054864786*^9}, {3.651210607592112*^9, 3.651210651445784*^9}, {
  3.651210790554881*^9, 3.651210810774939*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"CandidateA", "[", 
   RowBox[{"rl_", ",", "k_", ",", "range_", ",", "sample_"}], "]"}], ":=", 
  RowBox[{"Select", "[", 
   RowBox[{"sample", ",", 
    RowBox[{
     RowBox[{
      RowBox[{"FromDigits", "[", 
       RowBox[{
        RowBox[{"CellularAutomaton", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"rl", ",", "2", ",", "range"}], "}"}], ",", 
          RowBox[{"IntegerDigits", "[", 
           RowBox[{"#", ",", "2", ",", "k"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"{", "k", "}"}], "}"}], "}"}]}], "]"}], ",", "2"}], "]"}],
       "==", "#"}], "&"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5827291408463373`*^9, 3.5827292045412493`*^9}, {
  3.582729236240505*^9, 3.5827292662237577`*^9}, {3.5829260339756174`*^9, 
  3.5829260380004244`*^9}, {3.5839141048814487`*^9, 3.583914141458921*^9}, {
  3.584116902446176*^9, 3.584116902928474*^9}, {3.584117252036819*^9, 
  3.5841172525233727`*^9}, {3.584120188530408*^9, 3.584120219790351*^9}, {
  3.584513420133692*^9, 3.584513444792041*^9}, {3.584611360991355*^9, 
  3.584611400712414*^9}, {3.584617167143735*^9, 3.5846172001303873`*^9}, {
  3.5846173443801823`*^9, 3.584617344667248*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"CandidateB", "[", 
   RowBox[{"rl_", ",", "a_", ",", "k_", ",", "range_", ",", "sample_"}], 
   "]"}], ":=", 
  RowBox[{"Select", "[", 
   RowBox[{
    RowBox[{"Complement", "[", 
     RowBox[{"sample", ",", "a"}], "]"}], ",", 
    RowBox[{
     RowBox[{"MatchQ", "[", 
      RowBox[{
       RowBox[{"FromDigits", "[", 
        RowBox[{
         RowBox[{"CellularAutomaton", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"rl", ",", "2", ",", "range"}], "}"}], ",", 
           RowBox[{"Flatten", "[", 
            RowBox[{"IntegerDigits", "[", 
             RowBox[{"#", ",", "2", ",", "k"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"{", "k", "}"}], "}"}], "}"}]}], "]"}], ",", "2"}], 
        "]"}], ",", 
       RowBox[{"Alternatives", "@@", "a"}]}], "]"}], "&"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.5827291408463373`*^9, 3.5827292045412493`*^9}, {
   3.582729236240505*^9, 3.5827293121658382`*^9}, {3.582926042259232*^9, 
   3.582926049840845*^9}, {3.5839143499181747`*^9, 3.583914370264674*^9}, {
   3.584120618355674*^9, 3.5841206231122923`*^9}, 3.584122244138432*^9, 
   3.584257702134388*^9, {3.584611177549675*^9, 3.5846111977399883`*^9}, {
   3.584612525296523*^9, 3.584612553035048*^9}, {3.584617229969116*^9, 
   3.584617242215146*^9}, {3.584617350250781*^9, 3.584617350609922*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"CandidateC", "[", 
   RowBox[{
   "rl_", ",", "a_", ",", "b_", ",", "k_", ",", "range_", ",", "sample_"}], 
   "]"}], ":=", 
  RowBox[{"Select", "[", 
   RowBox[{
    RowBox[{"Complement", "[", 
     RowBox[{"sample", ",", "a", ",", "b"}], "]"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"FromDigits", "[", 
       RowBox[{
        RowBox[{"CellularAutomaton", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"rl", ",", "2", ",", "range"}], "}"}], ",", 
          RowBox[{"Flatten", "[", 
           RowBox[{"IntegerDigits", "[", 
            RowBox[{"#", ",", "2", ",", "k"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"2", "k"}], "}"}], "}"}], "}"}]}], "]"}], ",", "2"}], 
       "]"}], "\[Equal]", "#"}], "&"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5827291408463373`*^9, 3.5827292045412493`*^9}, {
   3.582729236240505*^9, 3.582729349683904*^9}, {3.582926053054451*^9, 
   3.5829260574224586`*^9}, {3.583914377995883*^9, 3.5839143859001837`*^9}, 
   3.584122267714323*^9, 3.5842576760156927`*^9, {3.584611201262329*^9, 
   3.584611206585898*^9}, {3.58461381572171*^9, 3.5846138431144447`*^9}, {
   3.584617247262673*^9, 3.584617257198729*^9}, {3.5846173547706413`*^9, 
   3.58461735511545*^9}, 3.61313883694195*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"CheckCandidate", "[", 
   RowBox[{"rl_", ",", "cand_", ",", "k_", ",", "range_"}], "]"}], ":=", 
  RowBox[{"CheckCandidateCore", "[", 
   RowBox[{"rl", ",", "cand", ",", 
    RowBox[{"{", 
     RowBox[{
     "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "1", ",", 
      "1", ",", "1", ",", "1", ",", "0", ",", "1"}], "}"}], ",", "k", ",", 
    "range"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5827293704631405`*^9, 3.5827293785283546`*^9}, {
   3.5827294438768697`*^9, 3.5827294630805035`*^9}, {3.582926060480064*^9, 
   3.582926068061677*^9}, {3.582928137047511*^9, 3.582928154550742*^9}, {
   3.5829282944205875`*^9, 3.5829283028914027`*^9}, {3.584106874058097*^9, 
   3.584106880162496*^9}, {3.584107008614132*^9, 3.584107009389015*^9}, {
   3.584108084072413*^9, 3.584108086432458*^9}, {3.584108163647923*^9, 
   3.584108167870071*^9}, 3.5847810793742847`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Candidates", "[", 
   RowBox[{"rl_", ",", "k_", ",", "range_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"limit", ",", "a", ",", "b", ",", "c"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"limit", "=", 
      RowBox[{
       RowBox[{"2", "^", "k"}], "-", "1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"CandidateA", "[", 
          RowBox[{"rl", ",", "k", ",", "range", ",", 
           RowBox[{"{", "i", "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", "limit"}], "}"}]}], "]"}], "]"}]}], ";", 
     RowBox[{"b", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"CandidateB", "[", 
          RowBox[{"rl", ",", "a", ",", "k", ",", "range", ",", 
           RowBox[{"{", "i", "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "limit"}], "}"}]}], "]"}], "]"}]}], ";", 
     RowBox[{"c", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"CandidateC", "[", 
          RowBox[{"rl", ",", "a", ",", "b", ",", "k", ",", "range", ",", 
           RowBox[{"{", "i", "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", "limit"}], "}"}]}], "]"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"samplea", ",", "sampleb", ",", "samplec"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"samplea", "=", "a"}], ";", "\[IndentingNewLine]", 
        RowBox[{"sampleb", "=", "b"}], ";", "\[IndentingNewLine]", 
        RowBox[{"samplec", "=", "c"}], ";", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Subsets", "[", 
             RowBox[{
              RowBox[{"Flatten", "[", 
               RowBox[{
                StyleBox["{", "Code"], 
                RowBox[{"samplea", ",", "samplec"}], "}"}], "]"}], ",", 
              RowBox[{"{", "2", "}"}]}], "]"}], ",", 
            RowBox[{
             RowBox[{"CheckCandidate", "[", 
              RowBox[{"rl", ",", "#", ",", "k", ",", "range"}], "]"}], 
             "&"}]}], "]"}], ",", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"FromDigits", "[", 
                  RowBox[{
                   RowBox[{"CellularAutomaton", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"rl", ",", "2", ",", "range"}], "}"}], ",", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{"#", ",", "2", ",", "k"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"{", "k", "}"}], "}"}], "}"}]}], "]"}], ",", 
                   "2"}], "]"}], ",", "#"}], "}"}], "&"}], ",", "sampleb"}], 
             "]"}], ",", 
            RowBox[{
             RowBox[{"CheckCandidate", "[", 
              RowBox[{"rl", ",", "#", ",", "k", ",", "range"}], "]"}], 
             "&"}]}], "]"}]}], "}"}]}]}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.582729486854945*^9, 3.5827295285226183`*^9}, {
   3.582729559098672*^9, 3.58272973452098*^9}, {3.582926071478083*^9, 
   3.582926107685747*^9}, {3.583914403175768*^9, 3.583914420768621*^9}, {
   3.5839145659849977`*^9, 3.583914579563054*^9}, {3.583914807400464*^9, 
   3.5839148082806063`*^9}, {3.584118953952757*^9, 3.5841190020674257`*^9}, {
   3.5841193037805567`*^9, 3.5841193181247473`*^9}, {3.5841195089971943`*^9, 
   3.5841195481780787`*^9}, {3.584459353637784*^9, 3.5844593540927467`*^9}, {
   3.584460176541329*^9, 3.584460229297859*^9}, {3.5844674899102697`*^9, 
   3.58446749154146*^9}, {3.5844677534509563`*^9, 3.584467764391637*^9}, {
   3.5844678362306337`*^9, 3.584467837021495*^9}, {3.5844681924379063`*^9, 
   3.584468193390744*^9}, {3.584507805367132*^9, 3.5845078058648653`*^9}, {
   3.584598567740081*^9, 3.58459857189149*^9}, {3.5846173256576033`*^9, 
   3.584617326213286*^9}, {3.5846174092773323`*^9, 3.5846174739422493`*^9}, 
   3.584617629874732*^9, {3.584625651793977*^9, 3.584625724419373*^9}, {
   3.5846257588426933`*^9, 3.584625809680292*^9}, {3.584626264935556*^9, 
   3.5846262667990828`*^9}, 3.584626301088449*^9, {3.584626486589346*^9, 
   3.58462648706732*^9}, {3.5846406646555157`*^9, 3.584640731779603*^9}, 
   3.5846712496548233`*^9, {3.5846793582073517`*^9, 3.5846793759314747`*^9}, {
   3.5846794219553967`*^9, 3.584679426464034*^9}, {3.584693487732346*^9, 
   3.584693550376913*^9}, {3.5846966020417852`*^9, 3.584696609299595*^9}, {
   3.5846966594417877`*^9, 3.58469666008818*^9}, {3.584697097444277*^9, 
   3.5846970982704363`*^9}, {3.584697137321156*^9, 3.5846971581835327`*^9}, {
   3.584704062198497*^9, 3.5847040631358967`*^9}, {3.584704129605665*^9, 
   3.584704129876417*^9}, 3.584704344740438*^9, {3.584704390526672*^9, 
   3.5847045063138857`*^9}, {3.584704644347877*^9, 3.584704646378675*^9}, {
   3.584704715888756*^9, 3.5847047804280777`*^9}, {3.584704853472762*^9, 
   3.5847048965473003`*^9}, {3.58470517590198*^9, 3.584705210936664*^9}, {
   3.5847052656263657`*^9, 3.584705331645504*^9}, {3.584705406428794*^9, 
   3.584705436914268*^9}, {3.5847062311307697`*^9, 3.584706244995399*^9}, {
   3.584706297253433*^9, 3.584706304549712*^9}, {3.5847063816073713`*^9, 
   3.5847064058545103`*^9}, {3.5847064671822577`*^9, 3.584706489531168*^9}, {
   3.584722726395281*^9, 3.584722748976964*^9}, {3.584804200165964*^9, 
   3.5848042007966423`*^9}, {3.613138807737493*^9, 3.6131388168321238`*^9}, {
   3.6131413735442657`*^9, 3.613141377367028*^9}, {3.613152262853231*^9, 
   3.613152278543418*^9}, {3.613152562436606*^9, 3.6131525711151953`*^9}, {
   3.613382648715766*^9, 3.6133826533787403`*^9}, {3.6150383704122562`*^9, 
   3.6150383708271*^9}, {3.652664634310759*^9, 3.6526647030348387`*^9}, {
   3.65266489657661*^9, 3.652664904318809*^9}, {3.652665755108243*^9, 
   3.652665772663919*^9}, {3.6526658795674953`*^9, 3.6526658934965477`*^9}, {
   3.65266638023431*^9, 3.6526664261338167`*^9}, {3.6526680391605167`*^9, 
   3.652668062236402*^9}, {3.6526682136235313`*^9, 3.65266825169602*^9}, {
   3.652668335172751*^9, 3.6526683694025517`*^9}, 3.652676930080755*^9, 
   3.65267702038932*^9, {3.652677052038681*^9, 3.652677090088183*^9}, {
   3.652678727380597*^9, 3.652678729068116*^9}, 3.6526854458239098`*^9, 
   3.652686376822043*^9, {3.652702230468892*^9, 3.652702274118935*^9}, {
   3.652702554674384*^9, 3.652702567959825*^9}, {3.652702648596445*^9, 
   3.65270269187941*^9}, {3.652702964695191*^9, 3.652703005070982*^9}, {
   3.652708304019342*^9, 3.652708353048994*^9}, {3.652709216750222*^9, 
   3.652709232674656*^9}, {3.65270932753913*^9, 3.65270932843291*^9}, {
   3.65271016707723*^9, 3.6527102092904787`*^9}, {3.6527564993686457`*^9, 
   3.652756501798028*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RuleNumECAExplicite", "[", 
   RowBox[{"rl_", ",", "cand_", ",", "k_", ",", "range_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{"k", ",", "cand", ",", 
    RowBox[{"FromDigits", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"FromDigits", "[", 
            RowBox[{"#", ",", "2"}], "]"}], "&"}], ",", 
          RowBox[{"Partition", "[", 
           RowBox[{
            RowBox[{"CellularAutomaton", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"rl", ",", "2", ",", "range"}], "}"}], ",", 
              RowBox[{"Flatten", "[", 
               RowBox[{"IntegerDigits", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                   "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "1", ",",
                     "1", ",", "1"}], "}"}], "/.", 
                  RowBox[{"MapThread", "[", 
                   RowBox[{"Rule", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], ",", "cand"}], "}"}], ",",
                     "1"}], "]"}]}], ",", "2", ",", "k"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{"{", "k", "}"}], "}"}], "}"}]}], "]"}], ",", "k"}], 
           "]"}]}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"{", 
          RowBox[{
          "7", ",", "8", ",", "5", ",", "1", ",", "6", ",", "4", ",", "3", 
           ",", "2"}], "}"}], "]"}], "]"}], "/.", 
       RowBox[{"MapThread", "[", 
        RowBox[{"Rule", ",", 
         RowBox[{"{", 
          RowBox[{"cand", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", "1"}], "]"}]}], ",",
       "2"}], "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.5829269799778795`*^9, 3.58292700325312*^9}, {
   3.5829270370739794`*^9, 3.582927049226401*^9}, {3.582927117523321*^9, 
   3.582927125619735*^9}, {3.582927597536164*^9, 3.5829276111705875`*^9}, {
   3.5829283584899006`*^9, 3.582928365681513*^9}, 3.5829285966253185`*^9, {
   3.5839148767694473`*^9, 3.5839148839700537`*^9}, {3.583918211890402*^9, 
   3.583918214449587*^9}, 3.583918247231475*^9, 3.583918397083363*^9, 
   3.583918435576406*^9, 3.583918733670576*^9, 3.583918795350327*^9, {
   3.583918841685062*^9, 3.5839189231280127`*^9}, 3.583919398267733*^9, 
   3.583928016481153*^9, 3.5839296618999043`*^9, {3.583930519310504*^9, 
   3.5839305269945593`*^9}, {3.5839305598985653`*^9, 3.58393056873081*^9}, {
   3.583998720670292*^9, 3.5839987210026693`*^9}, {3.584259888099332*^9, 
   3.584259912742827*^9}, {3.584260548426564*^9, 3.584260548736472*^9}, {
   3.613360971915906*^9, 3.613360994359041*^9}, 3.613451439115307*^9, {
   3.6512103337087317`*^9, 3.6512103590979013`*^9}, 3.651210528244697*^9, {
   3.65121061809599*^9, 3.6512106462764807`*^9}, {3.651210698204679*^9, 
   3.651210700292407*^9}, 3.6512107905799303`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DisplayTransformations", "[", 
   RowBox[{"rule_", ",", "startblocksize_", ",", "endblocksize_"}], "]"}], ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"rule", ",", 
        RowBox[{"#", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}], "/@", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"RuleNumECAExplicite", "[", 
             RowBox[{"rule", ",", "#", ",", "i", ",", "1"}], "]"}], "&"}], 
           ",", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Candidates", "[", 
              RowBox[{"rule", ",", "i", ",", "1"}], "]"}], ",", "1"}], 
            "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          StyleBox[
           RowBox[{"i", ",", "startblocksize", ",", "endblocksize"}], "Code"], 
          StyleBox["}", "Code"]}]}], 
        StyleBox["]", "Code"]}], 
       StyleBox[",", "Code"], 
       StyleBox["1", "Code"]}], 
      StyleBox["]", "Code"]}]}], 
    StyleBox[",", "Code"], 
    StyleBox["0", "Code"]}], 
   StyleBox["]", "Code"]}]}]], "Input",
 CellChangeTimes->{{3.584259683880043*^9, 3.58425968407876*^9}, {
   3.584259725981461*^9, 3.584259745599888*^9}, {3.584259787450447*^9, 
   3.584259791719775*^9}, {3.5842599244550247`*^9, 3.584260009869437*^9}, 
   3.584260066486752*^9, {3.584260113076865*^9, 3.5842601319503527`*^9}, {
   3.584260450120421*^9, 3.584260569709832*^9}, {3.584260606150165*^9, 
   3.584260612437936*^9}, {3.584261317790495*^9, 3.5842613242434273`*^9}, {
   3.584261355860878*^9, 3.584261407779015*^9}, {3.584261439636639*^9, 
   3.584261606796339*^9}, {3.584261652033842*^9, 3.5842616767676773`*^9}, 
   3.584261812166974*^9, {3.584261981976412*^9, 3.584262268934186*^9}, {
   3.584262320075863*^9, 3.584262505269824*^9}, {3.5842719745558434`*^9, 
   3.584271988856691*^9}, {3.5843678578358173`*^9, 3.584367873825405*^9}, 
   3.584381903534622*^9, {3.5844291644067574`*^9, 3.584429164796677*^9}, {
   3.650986769866046*^9, 3.6509868069877787`*^9}, {3.6512101353949823`*^9, 
   3.6512101363875732`*^9}, {3.6512101788083363`*^9, 3.651210179603039*^9}, {
   3.6512102472976*^9, 3.651210248304186*^9}, {3.6512103670735207`*^9, 
   3.651210367957691*^9}, {3.65121044104018*^9, 3.651210441879925*^9}, {
   3.651210528255919*^9, 3.651210534184713*^9}, {3.651210570620255*^9, 
   3.651210571786449*^9}, {3.651210618114182*^9, 3.651210646287198*^9}, {
   3.6512107271130877`*^9, 3.651210728303199*^9}, {3.651217215711594*^9, 
   3.651217217188005*^9}, {3.6512376656144114`*^9, 3.651237714778314*^9}, {
   3.651237755845072*^9, 3.651237800749982*^9}, {3.6512429756097937`*^9, 
   3.651242977127474*^9}, {3.651369129681151*^9, 3.651369134257658*^9}, 
   3.6524514033270493`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Search ECA emulations", "Subsection",
 CellChangeTimes->{{3.653831139351966*^9, 3.65383122742605*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CreateGraphData", "[", "blocksize_", "]"}], ":=", 
   RowBox[{"Union", "[", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Union", "[", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"DisplayTransformations", "[", 
            RowBox[{"#", ",", "blocksize", ",", "blocksize"}], "]"}], "&"}], "/@",
           "ECAClass"}], ")"}], "]"}], "/.", " ", 
       RowBox[{
        RowBox[{"{", "}"}], " ", "\[Rule]", " ", 
        RowBox[{"Sequence", "[", "]"}]}]}], ",", "1"}], "]"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.6523856370119247`*^9, 3.652385797104032*^9, {3.6523859785624237`*^9, 
   3.6523859852399683`*^9}, 3.65240859899328*^9, {3.6524514612232924`*^9, 
   3.6524514661902733`*^9}}],

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"ParallelTable", "[", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"\"\<ECA\>\"", "<>", 
       RowBox[{"ToString", "[", "blocksize", "]"}], "<>", "\"\<.txt\>\""}], 
      ",", 
      RowBox[{"CreateGraphData", "[", "blocksize", "]"}], ",", 
      "\"\<Table\>\"", ",", 
      RowBox[{"\"\<FieldSeparators\>\"", "\[Rule]", "\"\<,\>\""}], ",", 
      RowBox[{"ShowStringCharacters", "\[Rule]", "False"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"blocksize", ",", "2", ",", "20", ",", "1"}], "}"}]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.652385654178915*^9, 3.6523856780717688`*^9}, 
   3.652386168843865*^9, 3.6523862656433067`*^9, {3.652386375348748*^9, 
   3.6523863760606203`*^9}, {3.652711423457399*^9, 3.652711433493413*^9}, {
   3.652711553053625*^9, 3.652711555434888*^9}, {3.652711587744996*^9, 
   3.6527116096944227`*^9}, {3.652711787414632*^9, 3.652711795204711*^9}, {
   3.6527118260611057`*^9, 3.652711828083552*^9}, {3.652712106127647*^9, 
   3.65271212823524*^9}, {3.652714953245697*^9, 3.65271495603126*^9}, {
   3.652715905398139*^9, 3.6527159095698023`*^9}, {3.6527159467465973`*^9, 
   3.652715950432191*^9}, {3.652716714655818*^9, 3.652716718028858*^9}, {
   3.6527202127657013`*^9, 3.6527202129480658`*^9}, {3.65272121370284*^9, 
   3.652721218916621*^9}, {3.6527221992379007`*^9, 3.652722199865786*^9}, {
   3.652722564970809*^9, 3.652722567510421*^9}, {3.652722709978469*^9, 
   3.6527227124905653`*^9}, {3.652722940161903*^9, 3.652722964874021*^9}, {
   3.652723170565724*^9, 3.652723173764276*^9}, {3.652723598889509*^9, 
   3.652723601710904*^9}, {3.652724368612813*^9, 3.6527243704280252`*^9}, 
   3.6527244216758747`*^9, {3.652724505680252*^9, 3.652724508183218*^9}, {
   3.652724671137431*^9, 3.652724674197332*^9}, {3.6527257346109943`*^9, 
   3.652725736273224*^9}, {3.652726134122363*^9, 3.652726139717207*^9}, 
   3.652754034214447*^9, {3.6527540977079763`*^9, 3.652754099938632*^9}, {
   3.652756535357738*^9, 3.652756557986375*^9}, {3.653830940013207*^9, 
   3.653830942211274*^9}}]
}, Open  ]]
},
WindowSize->{1023, 814},
WindowMargins->{{Automatic, -9}, {Automatic, 0}},
Magnification:>1.25 Inherited,
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (December 4, \
2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 108, 1, 54, "Subsection"],
Cell[690, 25, 1457, 23, 120, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2184, 53, 118, 1, 54, "Subsection"],
Cell[2305, 56, 1839, 45, 120, "Input"],
Cell[4147, 103, 1249, 27, 78, "Input"],
Cell[5399, 132, 1416, 33, 99, "Input"],
Cell[6818, 167, 1358, 32, 99, "Input"],
Cell[8179, 201, 917, 17, 57, "Input"],
Cell[9099, 220, 7235, 140, 309, "Input"],
Cell[16337, 362, 3094, 67, 183, "Input"],
Cell[19434, 431, 2901, 60, 120, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22372, 496, 108, 1, 54, "Subsection"],
Cell[22483, 499, 811, 22, 78, "Input"],
Cell[23297, 523, 2107, 36, 78, "Input"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
